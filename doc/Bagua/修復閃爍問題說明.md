# ä¿®å¾©é é¢æ¨¡å¼é–ƒçˆå•é¡Œ

## ğŸ› å•é¡Œæè¿°
åŸå…ˆçš„å¯¦ç¾æœƒå°è‡´é é¢è¼‰å…¥æ™‚å‡ºç¾é–ƒçˆæ•ˆæœï¼š
1. é é¢é¦–å…ˆé¡¯ç¤ºé è¨­çš„æœå°‹æ¨¡å¼
2. ç„¶å¾Œåœ¨ onMounted ä¸­è¼‰å…¥ä¿å­˜çš„ç‹€æ…‹
3. å¦‚æœä¿å­˜çš„æ˜¯å åœæ¨¡å¼ï¼Œæœƒçœ‹åˆ°å¾æœå°‹æ¨¡å¼è·³è½‰åˆ°å åœæ¨¡å¼çš„é–ƒçˆ

## âœ… è§£æ±ºæ–¹æ¡ˆ
ä¿®æ”¹ç‚ºåœ¨ ref åˆå§‹åŒ–æ™‚å°±ç›´æ¥ä½¿ç”¨æ­£ç¢ºçš„ç‹€æ…‹ï¼š

### æ–°çš„å¯¦ç¾æ–¹å¼
```javascript
// ç«‹å³è¼‰å…¥ä¿å­˜çš„ç‹€æ…‹ï¼ˆé¿å…é–ƒçˆæ•ˆæœï¼‰
const getInitialPageMode = () => {
  if (typeof window !== 'undefined') {
    const saved = localStorage.getItem('easternDivination_pageMode')
    return (saved && ['search', 'divination'].includes(saved)) ? saved : 'search'
  }
  return 'search'
}

const getInitialDivinationMode = () => {
  if (typeof window !== 'undefined') {
    const saved = localStorage.getItem('easternDivination_divinationMode')
    return (saved && ['yinyang', 'coins'].includes(saved)) ? saved : 'yinyang'
  }
  return 'yinyang'
}

// ç›´æ¥ä½¿ç”¨æ­£ç¢ºçš„åˆå§‹å€¼
const pageMode = ref(getInitialPageMode())
const divinationMode = ref(getInitialDivinationMode())
```

## ğŸ”§ ä¸»è¦æ”¹å‹•

### âœ… æ–°å¢åŠŸèƒ½
- `getInitialPageMode()`: ç«‹å³è®€å–é é¢æ¨¡å¼
- `getInitialDivinationMode()`: ç«‹å³è®€å–å åœæ¨¡å¼
- åŠ å…¥ `typeof window !== 'undefined'` æª¢æŸ¥ï¼ˆSSR å…¼å®¹ï¼‰

### ğŸ—‘ï¸ ç§»é™¤å…§å®¹
- `loadSavedStates()` å‡½æ•¸ï¼ˆä¸å†éœ€è¦ï¼‰
- `onMounted` ç”Ÿå‘½é€±æœŸé‰¤å­ä¸­çš„ç‹€æ…‹è¼‰å…¥
- `onMounted` å¾å°å…¥ä¸­ç§»é™¤
- æ§åˆ¶å°æ—¥èªŒè¼¸å‡ºï¼ˆæŒ‰ç”¨æˆ¶è¦æ±‚ï¼‰

### ğŸ“ ä¿ç•™åŠŸèƒ½
- `saveState()` å‡½æ•¸ï¼šç”¨æ–¼ä¿å­˜ç‹€æ…‹è®Šæ›´
- `togglePageMode()` å’Œ `toggleDivinationMode()`: ä»ç„¶æœƒä¿å­˜ç‹€æ…‹

## ğŸ¯ æ•ˆæœ

### ä¿®æ”¹å‰
```
è¼‰å…¥é é¢ â†’ é¡¯ç¤ºæœå°‹æ¨¡å¼ â†’ onMounted åŸ·è¡Œ â†’ è·³è½‰åˆ°å åœæ¨¡å¼ âŒ é–ƒçˆ
```

### ä¿®æ”¹å¾Œ  
```
è¼‰å…¥é é¢ â†’ ç›´æ¥é¡¯ç¤ºæ­£ç¢ºçš„å åœæ¨¡å¼ âœ… ç„¡é–ƒçˆ
```

## âš¡ æ€§èƒ½å„ªåŒ–
- æ¸›å°‘äº†ä¸å¿…è¦çš„ç‹€æ…‹è®Šæ›´
- ç§»é™¤äº† onMounted ç”Ÿå‘½é€±æœŸ
- ç›´æ¥åœ¨åˆå§‹åŒ–æ™‚è¨­ç½®æ­£ç¢ºç‹€æ…‹

## ğŸ›¡ï¸ å…¼å®¹æ€§
- åŠ å…¥äº† SSR æª¢æŸ¥ `typeof window !== 'undefined'`
- ç¢ºä¿åœ¨æœå‹™ç«¯æ¸²æŸ“ç’°å¢ƒä¸­ä¸æœƒå‡ºéŒ¯
- ä¿æŒåŸæœ‰çš„è¼¸å…¥é©—è­‰é‚è¼¯

ç¾åœ¨ç”¨æˆ¶å›åˆ°ç¶²é æ™‚ï¼Œæœƒç›´æ¥çœ‹åˆ°ä¸Šæ¬¡é¸æ“‡çš„æ¨¡å¼ï¼Œæ²’æœ‰ä»»ä½•é–ƒçˆæ•ˆæœï¼ğŸ‰
